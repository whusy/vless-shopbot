{% extends "base.html" %} {% block title %}–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–æ—Ç–∞ –∏ –•–æ—Å—Ç–æ–≤{% endblock %}
{% block content %}

<h1>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h1>

<div class="settings-container">
	<div class="settings-column-left">
		<section class="settings-section">
			<h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –•–æ—Å—Ç–∞–º–∏ (–°–µ—Ä–≤–µ—Ä–∞–º–∏)</h2>

			<div class="host-card">
				<h4>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ö–æ—Å—Ç</h4>
				<form action="{{ url_for('add_host_route') }}" method="post">
					<div class="form-group">
						<label for="host_name">–ù–∞–∑–≤–∞–Ω–∏–µ —Ö–æ—Å—Ç–∞:</label>
						<input
							type="text"
							id="host_name"
							name="host_name"
							required
							maxlength="26"
						/>
					</div>
					<div class="form-group">
						<label for="host_url">URL –ø–∞–Ω–µ–ª–∏ XUI:</label>
						<input
							type="url"
							id="host_url"
							name="host_url"
							placeholder="http://123.45.67.89:54321"
							required
						/>
					</div>
					<div class="form-group">
						<label for="host_username">–õ–æ–≥–∏–Ω XUI:</label>
						<input
							type="text"
							id="host_username"
							name="host_username"
							required
						/>
					</div>
					<div class="form-group password-wrapper">
						<label for="host_pass">–ü–∞—Ä–æ–ª—å XUI:</label>
						<input type="password" id="host_pass" name="host_pass" required />
						<button type="button" class="toggle-password">üëÅÔ∏è</button>
					</div>
					<div class="form-group">
						<label for="host_inbound_id">ID –≤—Ö–æ–¥—è—â–µ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:</label>
						<input
							type="number"
							id="host_inbound_id"
							name="host_inbound_id"
							required
						/>
					</div>
					<button type="submit" class="button button-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
				</form>
			</div>

			{% if hosts %} {% for host in hosts %}
			<div class="host-card">
				<div class="host-header">
					<h3>{{ host.host_name }}</h3>
					<form
						action="{{ url_for('delete_host_route', host_name=host.host_name) }}"
						method="post"
						data-confirm="–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ö–æ—Å—Ç –∏ –≤—Å–µ –µ–≥–æ —Ç–∞—Ä–∏—Ñ—ã?"
					>
						<button type="submit" class="button button-danger button-small">
							–£–¥–∞–ª–∏—Ç—å
						</button>
					</form>
				</div>
				<p><strong>URL:</strong> {{ host.host_url }}</p>
				<div class="plans-section">
					<h4>–¢–∞—Ä–∏—Ñ—ã:</h4>
					{% if host.plans %}
					<ul class="plan-list">
						{% for plan in host.plans %}
						<li>
							<span>
								{{ plan.plan_name }} - {{ plan.price|round(0) }} RUB
							</span>
							<form
								action="{{ url_for('delete_plan_route', plan_id=plan.plan_id) }}"
								method="post"
							>
								<button type="submit" class="button button-danger button-tiny">
									√ó
								</button>
							</form>
						</li>
						{% endfor %}
					</ul>
					{% else %}
					<p>–¢–∞—Ä–∏—Ñ—ã –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã.</p>
					{% endif %}
					<h5>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–∞—Ä–∏—Ñ:</h5>
					<form
						action="{{ url_for('add_plan_route') }}"
						method="post"
						class="form-inline"
					>
						<input
							type="hidden"
							name="host_name"
							value="{{ host.host_name }}"
						/>
						<input
							type="text"
							name="plan_name"
							placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ"
							required
						/>
						<input type="number" name="months" placeholder="–ú–µ—Å." required />
						<input
							type="number"
							step="0.01"
							name="price"
							placeholder="–¶–µ–Ω–∞"
							required
						/>
						<button type="submit" class="button button-primary button-small">
							+
						</button>
					</form>
				</div>
			</div>
			{% endfor %} {% else %}
			<p>–•–æ—Å—Ç—ã –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã.</p>
			{% endif %}
		</section>
	</div>

	<div class="settings-column-right">
		<form action="{{ url_for('settings_page') }}" method="post">
			<section class="settings-section">
				<h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ü–∞–Ω–µ–ª–∏</h2>
				<div class="form-group">
					<label for="panel_login">–õ–æ–≥–∏–Ω –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –ø–∞–Ω–µ–ª—å:</label>
					<input
						type="text"
						id="panel_login"
						name="panel_login"
						value="{{ settings.panel_login or '' }}"
						required
					/>
				</div>
				<div class="form-group password-wrapper">
					<label for="panel_password"
						>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, —á—Ç–æ–±—ã –Ω–µ –º–µ–Ω—è—Ç—å):</label
					>
					<input type="password" id="panel_password" name="panel_password" />
					<button type="button" class="toggle-password">üëÅÔ∏è</button>
				</div>
			</section>

			<section class="settings-section">
				<h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–æ—Ç–∞</h2>
				<div class="form-group password-wrapper">
					<label for="telegram_bot_token">–¢–æ–∫–µ–Ω –±–æ—Ç–∞:</label>
					<input
						type="password"
						id="telegram_bot_token"
						name="telegram_bot_token"
						value="{{ settings.telegram_bot_token or '' }}"
						required
					/>
					<button type="button" class="toggle-password">üëÅÔ∏è</button>
				</div>
				<div class="form-group">
					<label for="telegram_bot_username">Username –±–æ—Ç–∞ (–±–µ–∑ @):</label>
					<input
						type="text"
						id="telegram_bot_username"
						name="telegram_bot_username"
						value="{{ settings.telegram_bot_username or '' }}"
						required
					/>
				</div>
				<div class="form-group">
					<label for="admin_telegram_id">Telegram ID –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:</label>
					<input
						type="text"
						id="admin_telegram_id"
						name="admin_telegram_id"
						value="{{ settings.admin_telegram_id or '' }}"
						required
					/>
				</div>
			</section>
			<section class="settings-section">
				<h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ü–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ –ë–æ—Ç–∞-–°–∞–ø–ø–æ—Ä—Ç–∞</h2>
				<div class="form-group">
					<label for="support_user">URL –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏–ª–∏ –ë–æ—Ç–∞-–°–∞–ø–ø–æ—Ä—Ç–∞:</label>
					<input
						type="text"
						id="support_user"
						name="support_user"
						value="{{ settings.support_user or '' }}"
					/>
				</div>
				<div class="form-group password-wrapper">
					<label for="support_bot_token"
						>–¢–æ–∫–µ–Ω Support-–±–æ—Ç–∞ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è):</label
					>
					<input
						type="password"
						id="support_bot_token"
						name="support_bot_token"
						value="{{ settings.support_bot_token or '' }}"
					/>
					<button type="button" class="toggle-password">üëÅÔ∏è</button>
				</div>
				<div class="form-group">
					<label for="support_group_id"
						>ID –ì—Ä—É–ø–ø—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ñ–æ—Ä—É–º–∞
						(Topics)):</label
					>
					<input
						type="text"
						id="support_group_id"
						name="support_group_id"
						value="{{ settings.support_group_id or '' }}"
					/>
				</div>
			</section>
			<section class="settings-section">
				<h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã</h2>
				<div class="form-group form-group-checkbox">
					<input type="hidden" name="enable_referrals" value="false" />
					<input type="checkbox" id="enable_referrals" name="enable_referrals"
					value="true" {% if settings.enable_referrals == 'true' %}checked{%
					endif %}>
					<label for="enable_referrals">–í–∫–ª—é—á–∏—Ç—å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É</label>
				</div>
				<div class="form-group">
					<label for="minimum_withdrawal">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞:</label>
					<input
						type="number"
						id="minimum_withdrawal"
						name="minimum_withdrawal"
						value="{{ settings.minimum_withdrawal or '10' }}"
					/>
				</div>
				<div class="form-group">
					<label for="referral_percentage"
						>–ü—Ä–æ—Ü–µ–Ω—Ç –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è –ø—Ä–∏–≥–ª–∞—Å–∏–≤—à–µ–º—É (%):</label
					>
					<input
						type="number"
						id="referral_percentage"
						name="referral_percentage"
						value="{{ settings.referral_percentage or '10' }}"
					/>
				</div>
				<div class="form-group">
					<label for="referral_discount"
						>–°–∫–∏–¥–∫–∞ –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –ø–µ—Ä–≤—É—é –ø–æ–∫—É–ø–∫—É (%):</label
					>
					<input
						type="number"
						id="referral_discount"
						name="referral_discount"
						value="{{ settings.referral_discount or '5' }}"
					/>
				</div>
			</section>
			<section class="settings-section">
				<h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ü—Ä–æ–±–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞</h2>
				<div class="form-group form-group-checkbox">
					<input type="hidden" name="trial_enabled" value="false" />
					<input type="checkbox" id="trial_enabled" name="trial_enabled"
					value="true" {% if settings.trial_enabled == 'true' %}checked{% endif
					%}>
					<label for="trial_enabled">–í–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥</label>
				</div>
				<div class="form-group">
					<label for="trial_duration_days"
						>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–±–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ (–≤ –¥–Ω—è—Ö):</label
					>
					<input
						type="number"
						id="trial_duration_days"
						name="trial_duration_days"
						value="{{ settings.trial_duration_days or '3' }}"
					/>
				</div>
			</section>
			<section class="settings-section">
				<h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ü–ª–∞—Ç–µ–∂–Ω—ã—Ö –°–∏—Å—Ç–µ–º</h2>
				<h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ YooKassa</h2>
				<div class="form-group">
					<label for="receipt_email">–ü–æ—á—Ç–∞ –¥–ª—è —á–µ–∫–æ–≤:</label>
					<input
						type="text"
						id="receipt_email"
						name="receipt_email"
						value="{{ settings.receipt_email or '' }}"
					/>
				</div>
				<div class="form-group">
					<label for="yookassa_shop_id">YooKassa Shop ID:</label>
					<input
						type="text"
						id="yookassa_shop_id"
						name="yookassa_shop_id"
						value="{{ settings.yookassa_shop_id or '' }}"
					/>
				</div>
				<div class="form-group password-wrapper">
					<label for="yookassa_secret_key">YooKassa Secret Key:</label>
					<input
						type="password"
						id="yookassa_secret_key"
						name="yookassa_secret_key"
						value="{{ settings.yookassa_secret_key or '' }}"
					/>
					<button type="button" class="toggle-password">üëÅÔ∏è</button>
				</div>
				<div class="form-group form-group-checkbox">
					<input type="hidden" name="sbp_enabled" value="false" />
					<input type="checkbox" id="sbp_enabled" name="sbp_enabled"
					value="true" {% if settings.sbp_enabled == 'true' %}checked{% endif
					%}>
					<label for="sbp_enabled">–í–∫–ª—é—á–∏—Ç—å –æ–ø–ª–∞—Ç—É —á–µ—Ä–µ–∑ –°–ë–ü</label>
				</div>
				<h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ CryptoBot</h2>
				<div class="form-group password-wrapper">
					<label for="cryptobot_token">CryptoBot Token:</label>
					<input
						type="password"
						id="cryptobot_token"
						name="cryptobot_token"
						value="{{ settings.cryptobot_token or '' }}"
					/>
					<button type="button" class="toggle-password">üëÅÔ∏è</button>
				</div>
				<h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Heleket</h2>
				<div class="form-group">
					<label for="heleket_merchant_id">Heleket Merchant ID:</label>
					<input
						type="text"
						id="heleket_merchant_id"
						name="heleket_merchant_id"
						value="{{ settings.heleket_merchant_id or '' }}"
					/>
				</div>
				<div class="form-group password-wrapper">
					<label for="heleket_api_key">Heleket API Key:</label>
					<input
						type="password"
						id="heleket_api_key"
						name="heleket_api_key"
						value="{{ settings.heleket_api_key or '' }}"
					/>
					<button type="button" class="toggle-password">üëÅÔ∏è</button>
				</div>
				<div class="form-group">
					<label for="domain">–í–∞—à –¥–æ–º–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, my-shop.com):</label>
					<input
						type="text"
						id="domain"
						name="domain"
						value="{{ settings.domain or '' }}"
					/>
				</div>
				<h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ TonConnect</h2>
				<div class="form-group">
					<label for="ton_wallet_address">Ton Wallet:</label>
					<input
						type="text"
						id="ton_wallet_address"
						name="ton_wallet_address"
						value="{{ settings.ton_wallet_address or '' }}"
					/>
				</div>
				<div class="form-group password-wrapper">
					<label for="tonapi_key">TonAPI Key:</label>
					<input
						type="password"
						id="tonapi_key"
						name="tonapi_key"
						value="{{ settings.tonapi_key or '' }}"
					/>
					<button type="button" class="toggle-password">üëÅÔ∏è</button>
				</div>
			</section>

			<section class="settings-section">
				<h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ö–æ–Ω—Ç–µ–Ω—Ç–∞</h2>
				<div class="form-group">
					<label for="about_text">–¢–µ–∫—Å—Ç "–û –ø—Ä–æ–µ–∫—Ç–µ":</label>
					<textarea id="about_text" name="about_text" rows="3">
{{
							settings.about_text or ""
						}}</textarea
					>
				</div>
				<div class="form-group">
					<label for="support_text">–¢–µ–∫—Å—Ç –≤ —Ä–∞–∑–¥–µ–ª–µ "–ü–æ–¥–¥–µ—Ä–∂–∫–∞":</label>
					<textarea id="support_text" name="support_text" rows="3">
{{
							settings.support_text or ""
						}}</textarea
					>
				</div>
				<div class="form-group">
					<label for="terms_url">URL "–£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è":</label>
					<input
						type="url"
						id="terms_url"
						name="terms_url"
						value="{{ settings.terms_url or '' }}"
					/>
				</div>
				<div class="form-group">
					<label for="privacy_url">URL "–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏":</label>
					<input
						type="url"
						id="privacy_url"
						name="privacy_url"
						value="{{ settings.privacy_url or '' }}"
					/>
				</div>
				<div class="form-group">
					<label for="channel_url"
						>URL Telegram-–∫–∞–Ω–∞–ª–∞ (–Ω–∞–ø—Ä. https://t.me/nnstorenews):</label
					>
					<input
						type="url"
						id="channel_url"
						name="channel_url"
						value="{{ settings.channel_url or '' }}"
					/>
				</div>
				<div class="form-group form-group-checkbox">
					<input type="hidden" name="force_subscription" value="false" />
					<input type="checkbox" id="force_subscription"
					name="force_subscription" value="true" {% if
					settings.force_subscription == 'true' %}checked{% endif %}>
					<label for="force_subscription"
						>–¢—Ä–µ–±–æ–≤–∞—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—É—é –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ –∫–∞–Ω–∞–ª</label
					>
				</div>
			</section>

			<button type="submit" class="button button-primary">
				–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
			</button>
		</form>
	</div>
</div>

{% endblock %}
